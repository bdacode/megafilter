<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Megafilter by naggie</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Megafilter</h1>
        <p>Easter 2013 project: My replacement for Google Reader, to produce a starred items feed. My copy publishes to http://callanbryant.co.uk/#Recommended</p>

        <p class="view"><a href="https://github.com/naggie/megafilter">View the Project on GitHub <small>naggie/megafilter</small></a></p>


        <ul>
          <li><a href="https://github.com/naggie/megafilter/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/naggie/megafilter/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/naggie/megafilter">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p>This is a personal replacement for Google reader. It's simple and suits my workflow.</p>

<p>Articles are added to a circular FIFO queue, so that the latest articles always appear
next. Articles can be:</p>

<ul>
<li>
<strong>Skipped</strong> (s) to be viewed later</li>
<li>
<strong>Published</strong> (p) to a JSONP 'RSS' feed</li>
<li>
<strong>Discarded</strong> (d) from the queue</li>
<li>
<strong>Inspected</strong> (i) to view the article from the original website, with comments</li>
</ul><p>Destructive actions can be undone (u).</p>

<p>The current article is synchronised across all devices, so you can continue reading
on yor smartphone.</p>

<p><strong>State: Very beta but working very well!</strong> I have migrated from Google reader
to Megafilter.</p>

<p><img src="http://callanbryant.co.uk/images/megafilter.png" alt="screenshot"></p>

<p><a href="http://callanbryant.co.uk/#Blog">See my blog post about it</a>.</p>

<pre><code>sudo npm install -g megafilter
# copy subscriptions.xml and starred.json from your google reader takeout to here
megafilter -s subscriptions.xml --import-greader-starred starred.json
open http://localhost:8080
</code></pre>

<p>The idea is that you run this on your own server. You can specify a PORT via
the environment variable or <code>--port</code>. Setcap can be used to run from port
80 without sudo; this is documented at the end of this file.</p>

<p>There will be a subscriptions manager soon. For the mean time, always start the
server with <code>-s subscriptions.xml</code>. Note that you only need to import once!</p>

<p>You can specify <code>--password &lt;password&gt;</code> to require auth. A <code>--username</code> can be
set, but this defaults to the executing user.</p>

<p>By default megafilter will save the published items to
<code>~/megafilter-published.json</code>. You can change this directory with <code>--store-dir</code></p>

<p>When megafilter starts, it will check each feed within the first 2 minutes
(this is so that servers don't get hammered) and after this, each feed will be
checked at the average post interval. Articles that are posted after the
initial check are added to the queue, so it may take a while for articles to
appear. If you are excited and/or impatient like me, then you may use the new
<code>--backfill 5</code> option, to initially add articles that were new in the last 5
hours. Articles will take 2 minutes to appear.</p>

<h2>RESTful JSON API</h2>

<blockquote>
<p><code>GET /next</code>
Get the next article. Returns <code>article</code> and <code>pending</code> count.</p>

<p><code>GET /current</code>
Get the current article (good for first load) returns <code>article</code> and <code>pending</code> count.</p>

<p><code>DELETE /queue/:id</code>
Discard an article from the queue.</p>

<p><code>PUT /publish/:id</code>
Publish an article by ID from the queue.</p>

<p><code>GET /published</code>
Given a <code>count</code> as parameter, return published articles. 0 Means all articles, unspecified  means 50.</p>

<p><code>GET /pending</code>
Gives the current number of articles pending</p>

<p><code>DELETE /published/:id</code>
Delete an article from the published collection</p>

<p><code>POST /enqueue</code>
Remotely adds an article to the queue.</p>
</blockquote>

<h2>Article format</h2>

<p>The same as the <a href="https://github.com/danmactough/node-feedparser">node-feedparser</a> format.</p>

<ul>
<li><code>title</code></li>
<li>
<code>description</code> (frequently, the full article content)</li>
<li>
<code>summary</code> (frequently, an excerpt of the article content)</li>
<li><code>link</code></li>
<li>
<code>origlink</code> (when FeedBurner or Pheedo puts a special tracking url in the <code>link</code> property, <code>origlink</code> contains the original link)</li>
<li>
<code>date</code> (most recent update)</li>
<li>
<code>pubdate</code> (original published date)</li>
<li><code>author</code></li>
<li>
<code>guid</code> (a unique identifier for the article)</li>
<li>
<code>comments</code> (a link to the article's comments section)</li>
<li>
<code>image</code> (an Object containing <code>url</code> and <code>title</code> properties)</li>
<li>
<code>categories</code> (an Array of Strings)</li>
<li>
<code>source</code> (an Object containing <code>url</code> and <code>title</code> properties pointing to the original source for an article; see the <a href="http://cyber.law.harvard.edu/rss/rss.html#ltsourcegtSubelementOfLtitemgt">RSS Spec</a> for an explanation of this element)</li>
<li>
<code>enclosures</code> (an Array of Objects, each representing a podcast or other enclosure and having a <code>url</code> property and possibly <code>type</code> and <code>length</code> properties)</li>
<li>
<code>meta</code> (an Object containing all the feed meta properties; especially handy when using the EventEmitter interface to listen to <code>article</code> emissions)</li>
</ul><h2>Published articles</h2>

<p>Currently, megafilter does not create a published RSS feed. If that's needed by
someone I'll add it. The reason I did not put it is because RSS is not
cross-domain, and is annoying to parse with jQuery.</p>

<p>The <code>/published</code> JSONP feed is simply the latest 50 published articles in the
format that <a href="https://github.com/danmactough/node-feedparser">node-feedparser</a> produces.</p>

<p>If you want an example on how to integrate the published items, see <a href="https://github.com/naggie/naggie.github.com/blob/master/js/src/engine.js">my website engine.</a></p>

<p>I'll probably make this available as part of megafilter.</p>

<h2>Running without sudo on port 80</h2>

<p>If you want to host on port 80 under ubuntu on your account, you can install <code>libcap2-bin</code>
then run <code>setcap 'cap_net_bind_service=+ep' /usr/local/bin/node</code> to give node access to port 80.</p>

<p>Your path to the <code>node</code> binary may vary, you can find it with <code>which node</code></p>

<h2>Acknowledgements</h2>

<p>Megafilter would not have been possible without the following awesome projects:</p>

<ul>
<li>
<a href="https://github.com/danmactough/node-feedparser">node feedparser</a>: Used to understand RSS feeds</li>
<li>
<a href="https://github.com/jeresig/jquery.hotkeys">jQuery hotkeys</a>: Used for the keyboard shorcuts</li>
<li>
<a href="http://fortawesome.github.io/Font-Awesome/">Font Awesome</a>: used for the UI graphics</li>
<li><a href="http://jquery.com">jQuery</a></li>
<li>
<a href="http://mcavage.github.io/node-restify/">node restify</a>: Used for the RESTful JSON API, and UI serving</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/naggie">naggie</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>